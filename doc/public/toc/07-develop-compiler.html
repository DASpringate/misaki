<!DOCTYPE html>
<html lang="en"><head><meta charset="utf-8"><meta content="width=device-width, initiali-scale=1.0, user-scalable=yes" name="viewport"><title>misaki document - Develop Compiler</title><link href="/favicon.ico" rel="shortcut icon"><link href="/atom.xml" rel="alternate" title="Develop Compiler" type="application/atom-xml"><link href="/misaki/css/prettify.css" rel="stylesheet" type="text/css"><link href="http://fonts.googleapis.com/css?family=Josefin+Sans" rel="stylesheet" type="text/css"><link href="/misaki/css/main.css" rel="stylesheet" type="text/css"><link href="/misaki/css/smartphone.css" media="only screen and (max-device-width:480px)" rel="stylesheet" type="text/css"></head><body><a class="github_ribbon" href="https://github.com/liquidz/misaki"><img alt="Fork me on GitHub" src="https://s3.amazonaws.com/github/ribbons/forkme_right_red_aa0000.png" style="position: absolute; top: 0; right: 0; border: 0;"></a><div class="container"><article><div class="page-header"><a href="/misaki/"><h1><span>D</span>evelop Compiler</h1></a><div class="tag"><ul></ul></div><p class="date"></p></div><div class="post"><h2><span>O</span>verview</h2><p class="paragraph">misaki allows you to develop your own compiler.
   There are 3 function to construct misaki's compiler.</p><dl><dt><code class="prettyprint">-extension</code></dt><dd>REQUIRED</dd><dt><code class="prettyprint">-config</code></dt><dd>OPTIONAL</dd><dt><code class="prettyprint">-compile</code></dt><dd>REQUIRED</dd></dl><h2><span>S</span>implest compiler sample</h2><p class="paragraph">Following compiler append <code class="prettyprint">(:text config)</code> to head of template file.</p><pre class="prettyprint lang-clj">(ns misaki.compiler.hello.core
  &quot;Namespace must be misaki.compiler.***.core
  '***' is a compiler name.&quot;)

(defn -extension
  &quot;Specify file extensions to watch in misaki.&quot;
  []
  (list :txt))

(defn -config
  &quot;If your compiler handles custom configuration,
  you can set original data in this function.&quot;
  [config]
  (assoc config :text &quot;hello, &quot;))

(defn -compiler
  &quot;Called when watched files are updated.
  If you returns...
     * string : Write string to file named as same as template file.
     * boolean: Do nothing.
     * map    : Write file with detailed setting.
                `:status`   -&gt; Compile result(true/false)
                `:filename` -&gt; Filename to write
                `:body`     -&gt; Compiled body text. if body is nil, only status is checked
                `:stop-compile?` -&gt; Flag(true/false) to stop all compilation
                `:all-compile?`  -&gt; Flag(true/false) to force compiling all templates&quot;
  [config file]
  (str (:text config) (slurp file)))</pre><p class="back">&raquo; <a href="/misaki/">Back to Top</a></p></div></article><footer class="footer"><p><a href="http://twitter.com/uochan">@uochan</a>&nbsp; 2012</p><p><a href="https://github.com/liquidz/misaki"><img alt="misaki banner" src="/misaki/img/misaki_banner.png"></a></p></footer></div><script src="/misaki/js/prettify.js" type="text/javascript"></script><script src="/misaki/js/lang-clj.js" type="text/javascript"></script><script src="/misaki/js/main.js" type="text/javascript"></script></body></html>